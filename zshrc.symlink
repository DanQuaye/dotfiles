# Path to your oh-my-zsh configuration.
# # the basics
: ${HOME=~}
: ${LOGNAME=$(id -un)}
: ${UNAME=$(uname)}
: ${ZSH=$HOME/.oh-my-zsh}
: ${DOTFILES=$HOME/.dotfiles}
: ${REPODIR=$HOME/src}

# ----------------------------------------------------------------------
# ONLY FOR INTERACTIVE SHELLS
# ----------------------------------------------------------------------

# Don't load bashrc if this isn't an interactive shell
if [ -z interactive ]; then
   return
fi

# ----------------------------------------------------------------------
# TERMINAL SETTINGS
# ----------------------------------------------------------------------

export TERM='xterm-256color'

# ----------------------------------------------------------------------
# BOXEN
# ----------------------------------------------------------------------

# source the boxen script, for great good

[ -f /opt/boxen/env.sh ] && source /opt/boxen/env.sh

# ----------------------------------------------------------------------
# TMUX
# ----------------------------------------------------------------------

# Start tmux in every new shell

if [[ -z "$TMUX" ]]; then

    VISORSESSION="visor"
    OTHERSESSION="dev"

    case "$ITERM_PROFILE" in

        "Visor")
            if tmux has-session -t $VISORSESSION; then
                exec tmux attach -t $VISORSESSION
            else
                exec tmux new-session -s $VISORSESSION
            fi
            ;;
        *)
            if tmux has-session -t $OTHERSESSION; then
                exec tmux attach -t $OTHERSESSION
            else
                exec tmux new-session -s $OTHERSESSION
            fi
            ;;

    esac

fi

# ----------------------------------------------------------------------
# ZSH SETTINGS
# ----------------------------------------------------------------------

export ZSH_CUSTOM=$DOTFILES/zsh_custom

# Set name of the theme to load.
ZSH_THEME="rumblesan"

# Turn off oh-my-zsh asking to update
DISABLE_AUTO_UPDATE=true

# Which plugins would you like to load? (plugins can be found in ~/.oh-my-zsh/plugins/*)
# Custom plugins may be added to ~/.oh-my-zsh/custom/plugins/
# Example format: plugins=(rails git textmate ruby lighthouse)
plugins=(git vi-mode brew cabal fabric history jira npm pip python sbt scala postgres virtualenv vagrant)

source $ZSH/oh-my-zsh.sh

# ----------------------------------------------------------------------
# PATH
# ----------------------------------------------------------------------

PATH=/usr/local/bin:$DOTFILES/bin:$DOTFILES/notes.txt:$DOTFILES/commiter8:$PATH

if [ -n $(command -v brew) ]; then
    export BREWPATH=`brew --prefix`

    # if brew and coreutils are installed, then add the gnubin to the path
    if [ -n $(command -v gls) ]; then

        PATH="$BREWPATH/opt/coreutils/libexec/gnubin:$PATH"
        MANPATH="$BREWPATH/opt/coreutils/libexec/gnuman:$MANPATH"

    fi

fi

# put ~/bin on PATH if you have it
if [ -d $HOME/bin ]; then
    PATH="$HOME/bin:$PATH"
fi
export PATH

# ----------------------------------------------------------------------
# ENVIRONMENT CONFIGURATION
# ----------------------------------------------------------------------

# ignore OSX folder setting files
FIGNORE="DS_Store"

# history stuff
export HISTCONTROL=ignoredups:ignorespace

# use good dircolors
if [ -n $(command -v dircolors) ]; then
    eval `dircolors $DOTFILES/dircolors.ansi-dark`
fi

# ----------------------------------------------------------------------
# PAGER / EDITOR
# ----------------------------------------------------------------------

# EDITOR
if [ -n $(command -v vim) ]; then
    EDITOR=vim
else
    EDITOR=vi
fi
export EDITOR

# PAGER
if [ -n $(command -v less) ]; then
    PAGER="less -FirSwX"
    MANPAGER="less -FiRswX"
else
    PAGER=more
    MANPAGER="$PAGER"
fi
export PAGER MANPAGER

# ----------------------------------------------------------------------
# INPUT
# ----------------------------------------------------------------------

# set vim bindings
set -o vi

# ----------------------------------------------------------------------
# COMPLETIONS
# ----------------------------------------------------------------------

# add custom completion scripts
fpath=($DOTFILES/completions $fpath)

# compsys initialization
autoload -U compinit
compinit

# show completion menu when number of options is at least 2
zstyle ':completion:*' menu select=2

# ----------------------------------------------------------------------
# ALIASES
# ----------------------------------------------------------------------

source $DOTFILES/aliases.sh

# ----------------------------------------------------------------------
# FUNCTIONS
# ----------------------------------------------------------------------

source $DOTFILES/functions.sh

# ----------------------------------------------------------------------
# NOTIFICATIONS
# ----------------------------------------------------------------------

source $DOTFILES/zsh-notify/notify.plugin.zsh

# ----------------------------------------------------------------------
# LANGUAGES
# ----------------------------------------------------------------------
# Specific config for any programming languages

for l in $DOTFILES/languages/*; do
    source $l
done

# ----------------------------------------------------------------------
# MISC
# ----------------------------------------------------------------------
# Used for machine specific settings

[ -f $HOME/.localrc ] && source $HOME/.localrc

