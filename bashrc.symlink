#!/bin/bash

# Guy John <http://rumblesan.com>
# guy@rumblesan.com
#
# Thanks to
# Ryan Tomayko <http://tomayko.com/about>
# Zach Holman <http://zachholman.com/about>
# probably others as well

# the basics
: ${HOME=~}
: ${LOGNAME=$(id -un)}
: ${UNAME=$(uname)}

# ----------------------------------------------------------------------
# ENVIRONMENT CONFIGURATION
# ----------------------------------------------------------------------

# ignore python bytecode
export FIGNORE=".pyc"

# history stuff
export HISTCONTROL=ignoredups:ignorespace
alias h=history

# ----------------------------------------------------------------------
# PATH
# ----------------------------------------------------------------------

export DOTFILES=$HOME/.dotfiles

PATH=/usr/local/bin:$DOTFILES/bin:$PATH

# put ~/bin on PATH if you have it
test -d "$HOME/bin" &&
PATH="$HOME/bin:$PATH"

export PATH

# ----------------------------------------------------------------------
# PROMPT
# ----------------------------------------------------------------------

if [ `hostname -s` = "Solaris" ]; then
    # Home laptop is blue
    export PS1='[\u@\[\033[00;34m\]\h\[\033[00m\]:\W]\# '
elif [ `hostname -s` = "patchwerk" ]; then
    # VPS is red
    export PS1='[\u@\[\033[00;31m\]\h\[\033[00m\]:\W]\# '
else
    # Work mac is green
    export PS1='[\u@\[\033[00;32m\]\h\[\033[00m\]:\W]\# '
fi;

# ----------------------------------------------------------------------
# WINDOW
# ----------------------------------------------------------------------

export PROMPT_COMMAND='echo -ne "\033]0;${USER}@${HOSTNAME}\007"'

# ----------------------------------------------------------------------
# PAGER / EDITOR
# ----------------------------------------------------------------------

# EDITOR
test -n "$(command -v vim)" &&
EDITOR=vim ||
EDITOR=vi
export EDITOR

# PAGER
if test -n "$(command -v less)" ; then
    PAGER="less -FirSwX"
    MANPAGER="less -FiRswX"
else
    PAGER=more
    MANPAGER="$PAGER"
fi
export PAGER MANPAGER

# ----------------------------------------------------------------------
# LS AND DIRCOLORS
# ----------------------------------------------------------------------

# By default, use normal ls and --color switch
alias ls="ls -h --color"

# if the dircolors utility is available, set that up to
dircolors="$(type -P gdircolors dircolors | head -1)"
test -n "$dircolors" && {
    COLORS=/etc/DIR_COLORS
    test -e "/etc/DIR_COLORS.$TERM"   && COLORS="/etc/DIR_COLORS.$TERM"
    test -e "$HOME/.dircolors"        && COLORS="$HOME/.dircolors"
    test ! -e "$COLORS"               && COLORS=
    eval `$dircolors --sh $COLORS`
}
unset dircolors

# Turn on colors for grep as well
alias grep="grep --color"

# ----------------------------------------------------------------------
# MISC
# ----------------------------------------------------------------------

# Used for machine specific settings
if [ -f "$HOME/.localrc" ]; then
    source "$HOME/.localrc"
fi

# ----------------------------------------------------------------------
# RUBY
# ----------------------------------------------------------------------

# Setup rbenv if it's on this machine
if test -n "$(command -v rbenv)" ; then
    eval "$(rbenv init -)"
fi

# ----------------------------------------------------------------------
# OSX
# ----------------------------------------------------------------------

# If this is OSX then source the bash.osx file

if [ "$UNAME" = Darwin ]; then
    source "$DOTFILES/bashrc.osx"
fi

